(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[592],{3521:function(){},5603:function(e,t,s){"use strict";s.r(t),s.d(t,{RealTimeDashboard:function(){return y}});var a=s(7437),n=s(2265),r=s(5526);class i{static async startTracking(e,t){try{await this.updatePresence(e,t,!0,"active"),this.setupHeartbeat(e,t),this.setupVisibilityListener(e,t),this.setupBeforeUnloadListener(e,t)}catch(e){}}static async stopTracking(e,t){try{let s="".concat(e,"-").concat(t),a=this.heartbeatIntervals.get(s);a&&(clearInterval(a),this.heartbeatIntervals.delete(s));for(let s=0;s<3;s++)try{await this.updatePresence(e,t,!1,"away");break}catch(e){if(2===s)throw e}setTimeout(()=>{this.cleanupExpiredPresence()},1e3)}catch(e){}}static async getActiveUsers(e){try{let{data:t,error:s}=await r.supabase.from("user_presence").select("*").eq("event_id",e);t&&(new Date().getTime(),this.PRESENCE_TIMEOUT,t.forEach((e,t)=>{e.last_seen}));let{data:a,error:n}=await r.supabase.from("user_presence").select("*").eq("event_id",e).eq("is_online",!0).gte("last_seen",new Date(Date.now()-this.PRESENCE_TIMEOUT).toISOString());if(n)return[];return(a||[]).map(e=>({userId:e.user_id,eventId:e.event_id,isOnline:e.is_online,lastSeen:e.last_seen,status:e.status}))}catch(e){return[]}}static async updatePresence(e,t,s,a){try{let n=new Date().toISOString(),{error:i}=await r.supabase.rpc("upsert_user_presence",{p_user_id:t,p_event_id:e,p_is_online:s,p_status:a,p_last_seen:n,p_updated_at:n});i&&await this.simpleUpsert(e,t,s,a,n)}catch(e){}}static async simpleUpsert(e,t,s,a,n){try{let{data:i,error:o}=await r.supabase.from("user_presence").update({is_online:s,status:a,last_seen:n,updated_at:n}).eq("user_id",t).eq("event_id",e).select();if(!i||0===i.length){let{error:i}=await r.supabase.from("user_presence").insert({user_id:t,event_id:e,is_online:s,status:a,last_seen:n,updated_at:n});i&&i.code}}catch(e){}}static setupHeartbeat(e,t){let s="".concat(e,"-").concat(t),a=this.heartbeatIntervals.get(s);a&&clearInterval(a);let n=setInterval(async()=>{await this.updatePresence(e,t,!0,"active")},this.HEARTBEAT_INTERVAL);this.heartbeatIntervals.set(s,n)}static setupVisibilityListener(e,t){if("undefined"==typeof document)return;let s=async()=>{document.hidden?await this.updatePresence(e,t,!0,"idle"):await this.updatePresence(e,t,!0,"active")};document.addEventListener("visibilitychange",s)}static setupBeforeUnloadListener(e,t){let s=async()=>{await this.updatePresence(e,t,!1,"away")};window.addEventListener("beforeunload",s)}static async cleanupExpiredPresence(){try{let e=new Date(Date.now()-this.PRESENCE_TIMEOUT).toISOString(),{data:t,error:s}=await r.supabase.from("user_presence").update({is_online:!1,status:"away"}).lt("last_seen",e).eq("is_online",!0).select(),a=new Date(Date.now()-2*this.PRESENCE_TIMEOUT).toISOString(),{data:n,error:i}=await r.supabase.from("user_presence").delete().lt("last_seen",a).select();i||n&&n.length;let o=new Date(Date.now()-3e4).toISOString(),{data:c,error:l}=await r.supabase.from("user_presence").delete().eq("status","away").lt("last_seen",o).select();l||c&&c.length}catch(e){}}static async forceCleanupEvent(e){try{let{data:t,error:s}=await r.supabase.from("user_presence").select("*").eq("event_id",e);if(s)return;if(t&&t.length>0){let{error:t}=await r.supabase.from("user_presence").update({is_online:!1,status:"away"}).eq("event_id",e)}}catch(e){}}static async getDebugInfo(e){try{let{data:t,error:s}=await r.supabase.from("user_presence").select("*").eq("event_id",e),{data:a,error:n}=await r.supabase.from("user_presence").select("*").eq("event_id",e).eq("is_online",!0).gte("last_seen",new Date(Date.now()-this.PRESENCE_TIMEOUT).toISOString());return{allPresence:t||[],activeUsers:a||[],heartbeatIntervals:Array.from(this.heartbeatIntervals.keys()),errors:{allError:s,activeError:n}}}catch(e){return{error:e instanceof Error?e.message:String(e)}}}}i.HEARTBEAT_INTERVAL=3e4,i.PRESENCE_TIMEOUT=45e3,i.heartbeatIntervals=new Map,i.cleanupInterval=null,i.cleanupInterval=setInterval(()=>{i.cleanupExpiredPresence()},1e4);class o{async getEventStats(e){try{let t={totalAttendees:0,onlineAttendees:0,totalMessages:0,totalSessions:0,totalEvents:0,activeConnections:0};try{let{count:e}=await this.supabase.from("events").select("id",{count:"exact"});t.totalEvents=e||0}catch(e){t.totalEvents=0}try{let s=this.supabase.from("attendees").select("id",{count:"exact"});e&&s.eq("event_id",e);let{count:a}=await s;if(t.totalAttendees=a||0,a&&a>0)try{let s=(e?await i.getActiveUsers(e):[]).length;s>0?t.onlineAttendees=s:a<=2?t.onlineAttendees=a:a<=5?t.onlineAttendees=Math.min(a,Math.floor(.8*a)):a<=20?t.onlineAttendees=Math.floor(.4*a):t.onlineAttendees=Math.floor(.25*a)}catch(e){a<=2?t.onlineAttendees=a:t.onlineAttendees=Math.floor(.3*a)}else t.onlineAttendees=0}catch(e){t.totalAttendees=0,t.onlineAttendees=0}try{let s=this.supabase.from("event_messages").select("id",{count:"exact"});e&&s.eq("event_id",e);let{count:a}=await s;t.totalMessages=a||0}catch(e){t.totalMessages=0}try{let s=this.supabase.from("sessions").select("id",{count:"exact"});e&&s.eq("event_id",e);let{count:a}=await s;t.totalSessions=a||0}catch(e){t.totalSessions=0}return t.activeConnections=Math.floor(.8*t.onlineAttendees),t}catch(e){return{totalAttendees:0,onlineAttendees:0,totalMessages:0,totalSessions:0,totalEvents:0,activeConnections:0}}}async getSessionStats(e){try{let t={totalSessions:0,liveSessions:0,completedSessions:0,upcomingSessions:0};try{let s=this.supabase.from("sessions").select("id, status, start_time, end_time");e&&s.eq("event_id",e);let{data:a}=await s;a&&(t.totalSessions=a.length,t.liveSessions=a.filter(e=>"live"===e.status).length,t.completedSessions=a.filter(e=>"completed"===e.status).length,t.upcomingSessions=a.filter(e=>"scheduled"===e.status).length)}catch(e){t.totalSessions=0,t.liveSessions=0,t.completedSessions=0,t.upcomingSessions=0}return t}catch(e){return{totalSessions:0,liveSessions:0,completedSessions:0,upcomingSessions:0}}}async getAttendeeStats(e){try{let t={totalAttendees:0,onlineAttendees:0,registeredToday:0,activeAttendees:0};try{let s=this.supabase.from("attendees").select("id, status, created_at, updated_at");e&&s.eq("event_id",e);let{data:a}=await s;if(a){t.totalAttendees=a.length,a.length>0?1===a.length?t.onlineAttendees=1:2===a.length?t.onlineAttendees=2:a.length<=5?t.onlineAttendees=Math.min(a.length,Math.floor(.8*a.length)):a.length<=20?t.onlineAttendees=Math.floor(.4*a.length):t.onlineAttendees=Math.floor(.25*a.length):t.onlineAttendees=0,t.activeAttendees=a.filter(e=>"registered"===e.status||"checked_in"===e.status).length;let e=new Date;e.setHours(0,0,0,0),t.registeredToday=a.filter(t=>new Date(t.created_at)>=e).length}}catch(e){t.totalAttendees=0,t.onlineAttendees=0,t.activeAttendees=0,t.registeredToday=0}return t}catch(e){return{totalAttendees:0,onlineAttendees:0,registeredToday:0,activeAttendees:0}}}async getMessageStats(e){try{let t={totalMessages:0,messagesToday:0,averageResponseTime:0,activeConversations:0};try{let s=this.supabase.from("event_messages").select("id, created_at",{count:"exact"});e&&s.eq("event_id",e);let{data:a,count:n}=await s;if(t.totalMessages=n||0,a){let e=new Date;e.setHours(0,0,0,0);let s=a.filter(t=>new Date(t.created_at)>=e).length;t.messagesToday=s}}catch(e){}return t}catch(e){return{totalMessages:0,messagesToday:0,averageResponseTime:0,activeConversations:0}}}async getConnectionStats(e){try{let t={activeConnections:0,totalConnections:0,averageConnectionTime:0,peakConnections:0};try{let s=(e?await i.getActiveUsers(e):[]).length;if(s>0)t.activeConnections=s;else{let{count:s}=await this.supabase.from("attendees").select("id",{count:"exact"}).eq("event_id",e);s&&s>0?s<=2?t.activeConnections=s:t.activeConnections=Math.min(s,2):t.activeConnections=0}}catch(e){t.activeConnections=0}return t.totalConnections=2*t.activeConnections,t.averageConnectionTime=0,t.peakConnections=t.activeConnections,t}catch(e){return{activeConnections:0,totalConnections:0,averageConnectionTime:0,peakConnections:0}}}constructor(){this.supabase=r.supabase}}let c=new o;var l=s(6546),d=s(7181);class u{async saveMessage(e){try{let t=crypto.randomUUID(),{data:s,error:a}=await this.supabase.from("event_messages").insert({id:t,event_id:e.eventId,user_id:e.userId,message:e.message,user_name:e.userName,metadata:e.metadata||{},created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(a)throw Error("Database error: ".concat(a.message));return this.mapRowToMessage(s)}catch(e){throw Error("Failed to save message: ".concat(e instanceof Error?e.message:"Unknown error"))}}async getEventMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;try{let{data:s,error:a}=await this.supabase.from("event_messages").select("*").eq("event_id",e).order("created_at",{ascending:!0}).limit(t);if(a)throw Error("Database error: ".concat(a.message));return(s||[]).map(e=>this.mapRowToMessage(e))}catch(e){return[]}}mapRowToMessage(e){return{id:e.id,eventId:e.event_id,userId:e.user_id,message:e.message,userName:e.user_name,metadata:e.metadata||{},createdAt:e.created_at,updatedAt:e.updated_at}}constructor(){this.supabase=r.supabase}}let m=new u;class h{static async getUserDisplayInfo(e){let t=this.getCachedUser(e);if(t)return t;try{var s,a,n,i,o,c;let{data:t,error:l}=await r.supabase.from("users").select("id, email, name").eq("id",e).single();if(l)return this.createFallbackDisplayInfo(e);if(!t){try{let{data:t}=await r.supabase.auth.getUser();if((null==t?void 0:null===(s=t.user)||void 0===s?void 0:s.id)===e){let s=(null===(a=t.user.user_metadata)||void 0===a?void 0:a.full_name)||(null===(n=t.user.email)||void 0===n?void 0:n.split("@")[0])||"User";return{id:e,displayName:s,email:t.user.email||void 0,avatarUrl:void 0}}}catch(e){}return this.createFallbackDisplayInfo(e)}let d=this.formatDisplayName(t.name,t.email);if(!t.name||""===t.name.trim())try{let{data:t}=await r.supabase.auth.getUser();(null==t?void 0:null===(i=t.user)||void 0===i?void 0:i.id)===e&&(d=(null===(o=t.user.user_metadata)||void 0===o?void 0:o.full_name)||(null===(c=t.user.email)||void 0===c?void 0:c.split("@")[0])||"User")}catch(e){}let u={id:t.id,displayName:d,email:t.email,avatarUrl:void 0};return this.cacheUser(e,u),u}catch(t){return this.createFallbackDisplayInfo(e)}}static async getMultipleUserDisplayInfo(e){let t=new Map,s=[];for(let a of e){let e=this.getCachedUser(a);e?t.set(a,e):s.push(a)}if(0===s.length)return t;try{let{data:e,error:l}=await r.supabase.from("users").select("id, email, name").in("id",s);if(l){for(let e of s)t.set(e,this.createFallbackDisplayInfo(e));return t}for(let s of e||[]){let e=this.formatDisplayName(s.name,s.email);if(!s.name||""===s.name.trim())try{var a,n,i,o,c;let{data:t}=await r.supabase.auth.getUser();(null==t?void 0:null===(a=t.user)||void 0===a?void 0:a.id)===s.id&&(e=(null===(i=t.user)||void 0===i?void 0:null===(n=i.user_metadata)||void 0===n?void 0:n.full_name)||(null===(c=t.user)||void 0===c?void 0:null===(o=c.email)||void 0===o?void 0:o.split("@")[0])||"User")}catch(e){}let l={id:s.id,displayName:e,email:s.email,avatarUrl:void 0};t.set(s.id,l),this.cacheUser(s.id,l)}for(let e of s)t.has(e)||t.set(e,this.createFallbackDisplayInfo(e));return t}catch(e){for(let e of s)t.set(e,this.createFallbackDisplayInfo(e));return t}}static formatDisplayName(e,t){return e&&e.trim()?e.trim():t?t.split("@")[0].split(".").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):"Anonymous User"}static createFallbackDisplayInfo(e){return{id:e,displayName:"User ".concat(e.slice(0,8)),email:"unknown@example.com",fullName:void 0,avatarUrl:void 0}}static getCachedUser(e){let t=this.cacheExpiry.get(e);return t&&Date.now()<t&&this.userCache.get(e)||null}static cacheUser(e,t){this.userCache.set(e,t),this.cacheExpiry.set(e,Date.now()+this.CACHE_DURATION)}static clearUserCache(e){this.userCache.delete(e),this.cacheExpiry.delete(e)}static clearAllCache(){this.userCache.clear(),this.cacheExpiry.clear()}}h.userCache=new Map,h.cacheExpiry=new Map,h.CACHE_DURATION=3e5;let g=e=>{let{eventId:t,initialCount:r}=e,[i,o]=(0,n.useState)(r),[c,l]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=async()=>{try{let{supabase:e}=await Promise.resolve().then(s.bind(s,5526)),{count:a}=await e.from("attendees").select("id",{count:"exact"}).eq("event_id",t);null!==a&&a!==i&&(o(a),l(!0),setTimeout(()=>l(!1),2e3))}catch(e){}};e();let a=setInterval(e,1e4);return()=>clearInterval(a)},[t,i]),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium",children:[i," attendees"]}),c&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-xs text-red-500",children:"LIVE"})]})]})},p=e=>{let{eventId:t,userId:r}=e,[o,c]=(0,n.useState)([]),[l,u]=(0,n.useState)(""),[g,p]=(0,n.useState)(!1),[v,f]=(0,n.useState)(!1),[x,y]=(0,n.useState)(null),[b,w]=(0,n.useState)(!0),S=(0,n.useRef)(null),E=()=>{var e;null===(e=S.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,n.useEffect)(()=>{E()},[o]),(0,n.useEffect)(()=>{let e=async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{i.startTracking(t,r);let e=await m.getEventMessages(t,50);c(e),w(!1);let{supabase:a}=await Promise.resolve().then(s.bind(s,5526));console.log("Supabase client:",a),console.log("Event ID:",t);try{let{data:e,error:t}=await a.from("events").select("id").limit(1);t?(console.log("Supabase connection test failed:",t),y("Database connection failed: ".concat(t.message))):console.log("Supabase connection test successful")}catch(e){console.log("Supabase connection test error:",e),y("Failed to connect to Supabase - check CORS settings")}let n=a.channel("event-chat-".concat(t));return console.log("Channel created:",n),n.on("broadcast",{event:"chat-message"},e=>{let{message:a,userId:n,userName:i,timestamp:o}=e;if(n===r)return;let l="Unknown User";i&&"You"!==i&&""!==i.trim()?l=i:n&&(l="User ".concat(n.slice(0,8)));let d="".concat(n||"unknown","-").concat(o||Date.now()),u={id:d,eventId:t,userId:n,message:a,userName:l,metadata:{},createdAt:o||new Date().toISOString(),updatedAt:o||new Date().toISOString()};c(e=>[...e,u]),n&&("Unknown User"===l||l.startsWith("User "))&&h.getUserDisplayInfo(n).then(e=>{c(t=>t.map(t=>t.id===d?{...t,userName:e.displayName}:t))}).catch(e=>{n&&Promise.resolve().then(s.bind(s,5526)).then(e=>{let{supabase:t}=e;return t.auth.getUser()}).then(e=>{var t,s,a,r,i;let{data:o}=e;if((null==o?void 0:null===(t=o.user)||void 0===t?void 0:t.id)===n){let e=(null===(a=o.user)||void 0===a?void 0:null===(s=a.user_metadata)||void 0===s?void 0:s.full_name)||(null===(i=o.user)||void 0===i?void 0:null===(r=i.email)||void 0===r?void 0:r.split("@")[0])||"User ".concat(n.slice(0,8));c(t=>t.map(t=>t.id===d?{...t,userName:e}:t))}}).catch(()=>{})})}).on("broadcast",{event:"typing"},e=>{}).subscribe(e=>{console.log("Supabase channel status:",e),f("SUBSCRIBED"===e),"SUBSCRIBED"===e?y(null):"CHANNEL_ERROR"===e?y("Channel connection failed"):"TIMED_OUT"===e?y("Connection timed out"):"CLOSED"===e?y("Connection closed"):y("Connection status: ".concat(e))}),setTimeout(()=>{v||(console.log("Connection timeout - still not connected after 5 seconds"),y("Connection timeout - check Supabase CORS and real-time settings"))},5e3),()=>{n.unsubscribe(),i.stopTracking(t,r)}}catch(t){y("Failed to setup chat connection"),f(!1),a<3&&setTimeout(()=>{e(a+1)},2e3*(a+1))}};e();let a=setInterval(()=>{},6e4);return()=>{clearInterval(a)}},[t,r]);let _=async e=>{if(e.preventDefault(),!l.trim())return;let a=l.trim(),n=new Date().toISOString(),i="You";try{if(i=(await h.getUserDisplayInfo(r)).displayName||"You","You"===i||i.startsWith("User "))try{var o,g,v;let{supabase:e}=await Promise.resolve().then(s.bind(s,5526)),{data:t}=await e.auth.getUser();(null==t?void 0:null===(o=t.user)||void 0===o?void 0:o.id)===r&&(i=(null===(g=t.user.user_metadata)||void 0===g?void 0:g.full_name)||(null===(v=t.user.email)||void 0===v?void 0:v.split("@")[0])||"User")}catch(e){}}catch(e){i="You"}try{let e=await m.saveMessage({eventId:t,userId:r,message:a,userName:i});c(t=>[...t,e]),u(""),p(!1),setTimeout(E,100),d.c.updateLastSeen(r,t);let{supabase:o}=await Promise.resolve().then(s.bind(s,5526)),l=o.channel("event-chat-".concat(t));await l.send({type:"broadcast",event:"chat-message",payload:{message:a,userId:r,userName:i,timestamp:n}})}catch(s){let e={id:"".concat(r,"-").concat(Date.now()),eventId:t,userId:r,message:a,userName:"You",metadata:{},createdAt:n,updatedAt:n};c(t=>[...t,e]),u(""),p(!1),setTimeout(E,100)}};return(0,a.jsxs)("div",{className:"border rounded-lg p-4 h-64 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2 pb-2 border-b",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Event Chat"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(v?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:v?"Connected":x||"Disconnected"}),!v&&(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"text-xs text-blue-500 hover:text-blue-700",children:"Retry"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-2 mb-4",children:[b?(0,a.jsxs)("div",{className:"text-center text-gray-500 text-sm py-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading messages..."]}):0===o.length?(0,a.jsx)("div",{className:"text-center text-gray-500 text-sm py-4",children:"No messages yet. Start the conversation!"}):o.map(e=>(0,a.jsx)("div",{className:"flex ".concat(e.userId===r?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-xs px-3 py-2 rounded-lg ".concat(e.userId===r?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"),children:[(0,a.jsx)("div",{className:"text-sm",children:e.message}),(0,a.jsxs)("div",{className:"text-xs opacity-75 mt-1",children:[e.userName," • ",new Date(e.createdAt).toLocaleTimeString()]})]})},e.id)),(0,a.jsx)("div",{ref:S})]}),(0,a.jsxs)("form",{onSubmit:_,className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",value:l,onChange:e=>{u(e.target.value),p(e.target.value.length>0)},placeholder:"Type a message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!v}),(0,a.jsx)("button",{type:"submit",disabled:!l.trim()||!v,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]}),g&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Typing..."})]})},v=e=>{let{eventId:t,maxDisplay:s=5}=e,[r,o]=(0,n.useState)([]),[c,l]=(0,n.useState)(new Map),[d,u]=(0,n.useState)(!0),[m,g]=(0,n.useState)(null);if((0,n.useEffect)(()=>{let e=async()=>{try{u(!0);let e=await i.getActiveUsers(t);o(e);let s=e.map(e=>e.userId).filter(Boolean);if(s.length>0){let e=await h.getMultipleUserDisplayInfo(s);l(e)}g(null)}catch(e){g("Failed to fetch users")}finally{u(!1)}};e();let s=setInterval(e,3e3);return()=>clearInterval(s)},[t]),d)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Online Users"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Loading..."})]});if(m)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Online Users"}),(0,a.jsxs)("div",{className:"text-sm text-red-500",children:["Error: ",m]})]});let p=r.length,v=r.slice(0,s);return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-700",children:["Online (",p,")"]}),(0,a.jsx)("div",{className:"space-y-1",children:v.map((e,t)=>{let s=e.userId,n=s?c.get(s):null,r=(null==n?void 0:n.displayName)||"User ".concat(s?s.slice(0,8):"Unknown");return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:r}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.status})]},s||t)})}),0===r.length&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"No users online"}),r.length>s&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["+",r.length-s," more"]})]})},f=e=>{let{eventId:t,maxItems:s=10}=e,[r,o]=(0,n.useState)([]),[c,l]=(0,n.useState)(new Map),[d,u]=(0,n.useState)(!0),[m,g]=(0,n.useState)(null);if((0,n.useEffect)(()=>{let e=async()=>{try{u(!0);let e=await i.getActiveUsers(t),a=e.map((e,t)=>({id:"activity_".concat(e.userId,"_").concat(Date.now(),"_").concat(t),userId:e.userId,type:"join",message:"joined the event",timestamp:new Date().toISOString()}));o(a.slice(0,s));let n=e.map(e=>e.userId).filter(Boolean);if(n.length>0){let e=await h.getMultipleUserDisplayInfo(n);l(e)}g(null)}catch(e){g("Failed to fetch activities")}finally{u(!1)}};e();let a=setInterval(e,5e3);return()=>clearInterval(a)},[t,s]),d)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Recent Activity"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Loading..."})]});if(m)return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Recent Activity"}),(0,a.jsxs)("div",{className:"text-sm text-red-500",children:["Error: ",m]})]});let p=e=>{switch(e){case"join":case"leave":return"\uD83D\uDC4B";case"message":return"\uD83D\uDCAC";case"update":return"✏️";case"view":return"\uD83D\uDC41️";case"interact":return"\uD83E\uDD1D";default:return"\uD83D\uDCDD"}},v=e=>{let t=new Date(e),s=new Date().getTime()-t.getTime(),a=Math.floor(s/6e4),n=Math.floor(s/36e5);return a<1?"Just now":a<60?"".concat(a,"m ago"):n<24?"".concat(n,"h ago"):t.toLocaleDateString()};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Recent Activity"}),(0,a.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:0===r.length?(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"No recent activity"}):r.map(e=>{let t=e.userId?c.get(e.userId):null,s=(null==t?void 0:t.displayName)||"User ".concat(e.userId?e.userId.slice(0,8):"Unknown");return(0,a.jsxs)("div",{className:"flex items-start space-x-2 text-sm",children:[(0,a.jsx)("span",{className:"text-lg",children:p(e.type)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:s}),(0,a.jsxs)("span",{className:"text-gray-600",children:[" ",e.message||e.type]})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:v(e.timestamp)})]})]},e.id)})})]})};var x=s(3196);let y=e=>{let{eventId:t,userId:r}=e,[o,u]=(0,n.useState)(!1),[m,h]=(0,n.useState)("connecting"),{eventStats:y,sessionStats:b,attendeeStats:w,messageStats:S,connectionStats:E,isLoading:_,error:k,lastUpdated:N,refetch:j}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{eventId:t,refreshInterval:s=3e4,autoRefresh:a=!0}=e,[r,i]=(0,n.useState)({eventStats:{totalAttendees:0,onlineAttendees:0,totalMessages:0,totalSessions:0,totalEvents:0,activeConnections:0},sessionStats:{totalSessions:0,liveSessions:0,completedSessions:0,upcomingSessions:0},attendeeStats:{totalAttendees:0,onlineAttendees:0,registeredToday:0,activeAttendees:0},messageStats:{totalMessages:0,messagesToday:0,averageResponseTime:0,activeConversations:0},connectionStats:{activeConnections:0,totalConnections:0,averageConnectionTime:0,peakConnections:0},isLoading:!0,error:null,lastUpdated:null,refetch:async()=>{}}),o=(0,n.useCallback)(async()=>{try{i(e=>({...e,isLoading:!0,error:null}));let[e,s,a,n,r]=await Promise.all([c.getEventStats(t),c.getSessionStats(t),c.getAttendeeStats(t),c.getMessageStats(t),c.getConnectionStats(t)]);i(t=>({...t,eventStats:e,sessionStats:s,attendeeStats:a,messageStats:n,connectionStats:r,isLoading:!1,error:null,lastUpdated:new Date}))}catch(e){i(t=>({...t,isLoading:!1,error:e instanceof Error?e.message:"Failed to fetch statistics"}))}},[t]);return(0,n.useEffect)(()=>{o()},[o]),(0,n.useEffect)(()=>{if(!a)return;let e=setInterval(o,s);return()=>clearInterval(e)},[o,s,a]),{...r,refetch:o}}({...t,eventId:e})}(t,{refreshInterval:2e3}),[I,C]=(0,n.useState)(null),[D,T]=(0,n.useState)(!0),[A,U]=(0,n.useState)("overview"),M=new x.P;return(0,n.useEffect)(()=>{let e=async()=>{try{h("connecting");let{supabase:e}=await Promise.resolve().then(s.bind(s,5526)),{data:t,error:a}=await e.from("events").select("id").limit(1);a?(h("error"),u(!1)):(h("connected"),u(!0))}catch(e){h("error"),u(!1)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]),(0,n.useEffect)(()=>{let e=async()=>{try{T(!0);let e=await M.getEventById(t);C(e)}catch(e){C(null)}finally{T(!1)}};t&&e()},[t]),(0,n.useEffect)(()=>{d.c.trackConnection(r,t),i.startTracking(t,r);let e=setInterval(()=>{d.c.updateLastSeen(r,t)},3e4),s=()=>{i.stopTracking(t,r)},a=()=>{document.hidden?i.stopTracking(t,r):(i.startTracking(t,r),j())};return window.addEventListener("beforeunload",s),document.addEventListener("visibilitychange",a),()=>{clearInterval(e),d.c.removeConnection(r,t),i.stopTracking(t,r),window.removeEventListener("beforeunload",s),document.removeEventListener("visibilitychange",a)}},[r,t]),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Live Event Dashboard"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Live updates and interactions for ",D?"Loading...":(null==I?void 0:I.title)||"Event #".concat(t)]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsx)(l._,{})})]}),!o&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-4 h-4 bg-yellow-500 rounded-full mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Connection Issue"}),(0,a.jsxs)("p",{className:"text-sm text-yellow-700",children:["Real-time features are currently unavailable. Status: ",m]})]})]})}),(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Overview",icon:"\uD83D\uDCCA"},{id:"chat",label:"Chat",icon:"\uD83D\uDCAC"},{id:"activity",label:"Activity",icon:"\uD83D\uDCDD"},{id:"users",label:"Users",icon:"\uD83D\uDC65"}].map(e=>(0,a.jsxs)("button",{onClick:()=>U(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat(A===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})}),(0,a.jsxs)("div",{className:"min-h-96",children:["overview"===A&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Live Attendance"}),(0,a.jsx)(g,{eventId:t,initialCount:w.onlineAttendees})]}),(0,a.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Event Updates"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[_&&(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,a.jsx)("button",{onClick:j,className:"px-3 py-1 text-xs bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-md transition-colors",disabled:_,children:"Refresh"})]})]}),k?(0,a.jsxs)("div",{className:"text-center text-red-600 text-sm bg-red-50 p-4 rounded-lg",children:["Error loading stats: ",k]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Attendance"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl text-center shadow-sm",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:_?"...":y.totalAttendees}),(0,a.jsx)("div",{className:"text-sm font-semibold text-blue-700 mb-1",children:"Total Attendees"}),(0,a.jsx)("div",{className:"text-xs text-blue-600",children:"Registered users"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl text-center shadow-sm",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-green-600 mb-2",children:_?"...":y.onlineAttendees}),(0,a.jsx)("div",{className:"text-sm font-semibold text-green-700 mb-1",children:"Online Now"}),(0,a.jsx)("div",{className:"text-xs text-green-600",children:"Currently active"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Activity"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,a.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl text-center shadow-sm",children:[(0,a.jsx)("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:_?"...":y.totalMessages}),(0,a.jsx)("div",{className:"text-sm font-semibold text-purple-700 mb-1",children:"Messages Sent"}),(0,a.jsx)("div",{className:"text-xs text-purple-600",children:"In event chat"})]})})]})]}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-teal-50 to-teal-100 p-6 rounded-xl shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold text-teal-600 mb-2",children:[_?"...":Math.round(y.onlineAttendees/Math.max(y.totalAttendees,1)*100),"%"]}),(0,a.jsx)("div",{className:"text-lg font-semibold text-teal-700 mb-1",children:"Engagement Rate"}),(0,a.jsx)("div",{className:"text-sm text-teal-600",children:"Percentage of attendees currently online"})]}),(0,a.jsx)("div",{className:"w-16 h-16 bg-teal-200 rounded-full flex items-center justify-center ml-6",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})})]}),N&&(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center bg-gray-50 px-3 py-2 rounded-md",children:["Last updated: ",N.toLocaleTimeString()]})]})]}),"chat"===A&&(0,a.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Event Chat"}),(0,a.jsx)(p,{eventId:t,userId:r})]}),"activity"===A&&(0,a.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activity"}),(0,a.jsx)(f,{eventId:t,maxItems:20})]}),"users"===A&&(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:(0,a.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"User Presence"}),(0,a.jsx)(v,{eventId:t,maxDisplay:10})]})})]})]})}},6546:function(e,t,s){"use strict";s.d(t,{_:function(){return d},I:function(){return l}});var a=s(7437),n=s(2265),r=s(9625),i=s(6885);(0,r.Ue)()((0,i.mW)((0,i.tJ)(e=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:t=>e({user:t,isAuthenticated:!!t,error:null}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),logout:()=>e({user:null,isAuthenticated:!1,error:null})}),{name:"auth-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})}),{name:"auth-store"})),(0,r.Ue)()((0,i.mW)((e,t)=>({events:[],currentEvent:null,isLoading:!1,error:null,setEvents:t=>e({events:t,error:null}),addEvent:t=>e(e=>({events:[...e.events,t],error:null})),updateEvent:t=>e(e=>{var s;return{events:e.events.map(e=>e.id===t.id?t:e),currentEvent:(null===(s=e.currentEvent)||void 0===s?void 0:s.id)===t.id?t:e.currentEvent,error:null}}),removeEvent:t=>e(e=>{var s;return{events:e.events.filter(e=>e.id!==t),currentEvent:(null===(s=e.currentEvent)||void 0===s?void 0:s.id)===t?null:e.currentEvent,error:null}}),setCurrentEvent:t=>e({currentEvent:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t})}),{name:"event-store"})),(0,r.Ue)()((0,i.mW)(e=>({sessions:[],currentSession:null,isLoading:!1,error:null,setSessions:t=>e({sessions:t,error:null}),addSession:t=>e(e=>({sessions:[...e.sessions,t],error:null})),updateSession:t=>e(e=>{var s;return{sessions:e.sessions.map(e=>e.id===t.id?t:e),currentSession:(null===(s=e.currentSession)||void 0===s?void 0:s.id)===t.id?t:e.currentSession,error:null}}),removeSession:t=>e(e=>{var s;return{sessions:e.sessions.filter(e=>e.id!==t),currentSession:(null===(s=e.currentSession)||void 0===s?void 0:s.id)===t?null:e.currentSession,error:null}}),setCurrentSession:t=>e({currentSession:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t})}),{name:"session-store"})),(0,r.Ue)()((0,i.mW)(e=>({attendees:[],isLoading:!1,error:null,setAttendees:t=>e({attendees:t,error:null}),addAttendee:t=>e(e=>({attendees:[...e.attendees,t],error:null})),updateAttendee:t=>e(e=>({attendees:e.attendees.map(e=>e.id===t.id?t:e),error:null})),removeAttendee:t=>e(e=>({attendees:e.attendees.filter(e=>e.id!==t),error:null})),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t})}),{name:"attendee-store"}));let o=(0,r.Ue)()((0,i.mW)((e,t)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,setNotifications:t=>e({notifications:t,unreadCount:t.filter(e=>"read"!==e.status).length,error:null}),addNotification:t=>e(e=>({notifications:[t,...e.notifications],unreadCount:e.unreadCount+("read"===t.status?0:1),error:null})),markAsRead:t=>e(e=>{let s=e.notifications.map(e=>e.id===t?{...e,status:"read",readAt:new Date().toISOString()}:e);return{notifications:s,unreadCount:s.filter(e=>"read"!==e.status).length,error:null}}),markAllAsRead:()=>e(e=>({notifications:e.notifications.map(e=>({...e,status:"read",readAt:new Date().toISOString()})),unreadCount:0,error:null})),removeNotification:t=>e(e=>{let s=e.notifications.find(e=>e.id===t);return{notifications:e.notifications.filter(e=>e.id!==t),unreadCount:e.unreadCount-((null==s?void 0:s.status)==="read"?0:1),error:null}}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t})}),{name:"notification-store"}));(0,r.Ue)()((0,i.mW)(e=>({connections:[],pendingConnections:[],isLoading:!1,error:null,setConnections:t=>e({connections:t,pendingConnections:t.filter(e=>"pending"===e.status),error:null}),addConnection:t=>e(e=>({connections:[...e.connections,t],pendingConnections:"pending"===t.status?[...e.pendingConnections,t]:e.pendingConnections,error:null})),updateConnection:t=>e(e=>({connections:e.connections.map(e=>e.id===t.id?t:e),pendingConnections:e.pendingConnections.filter(e=>e.id!==t.id||"pending"!==t.status),error:null})),removeConnection:t=>e(e=>({connections:e.connections.filter(e=>e.id!==t),pendingConnections:e.pendingConnections.filter(e=>e.id!==t),error:null})),setPendingConnections:t=>e({pendingConnections:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t})}),{name:"connection-store"})),(0,r.Ue)()((0,i.mW)(e=>({messages:{},isLoading:!1,error:null,setMessages:(t,s)=>e(e=>({messages:{...e.messages,[t]:s},error:null})),addMessage:(t,s)=>e(e=>({messages:{...e.messages,[t]:[...e.messages[t]||[],s]},error:null})),updateMessage:(t,s)=>e(e=>({messages:{...e.messages,[t]:(e.messages[t]||[]).map(e=>e.id===s.id?s:e)},error:null})),removeMessage:(t,s)=>e(e=>({messages:{...e.messages,[t]:(e.messages[t]||[]).filter(e=>e.id!==s)},error:null})),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t})}),{name:"message-store"})),(0,r.Ue)()((0,i.mW)((0,i.tJ)(e=>({sidebarOpen:!0,theme:"light",notificationsOpen:!1,mobileMenuOpen:!1,toggleSidebar:()=>e(e=>({sidebarOpen:!e.sidebarOpen})),setSidebarOpen:t=>e({sidebarOpen:t}),toggleTheme:()=>e(e=>({theme:"light"===e.theme?"dark":"light"})),setTheme:t=>e({theme:t}),toggleNotifications:()=>e(e=>({notificationsOpen:!e.notificationsOpen})),setNotificationsOpen:t=>e({notificationsOpen:t}),toggleMobileMenu:()=>e(e=>({mobileMenuOpen:!e.mobileMenuOpen})),setMobileMenuOpen:t=>e({mobileMenuOpen:t})}),{name:"ui-storage",partialize:e=>({theme:e.theme})}),{name:"ui-store"})),(0,r.Ue)()((0,i.mW)(e=>({isConnected:!1,connectionStatus:"disconnected",lastActivity:null,error:null,setConnected:t=>e({isConnected:t,connectionStatus:t?"connected":"disconnected",error:null}),setConnectionStatus:t=>e({connectionStatus:t,isConnected:"connected"===t,error:"error"===t?"Connection error":null}),setLastActivity:t=>e({lastActivity:t}),setError:t=>e({error:t,connectionStatus:t?"error":"disconnected",isConnected:!1})}),{name:"realtime-store"}));let c=e=>{let{id:t,title:s,message:r,type:i,duration:o=5e3,onClose:c}=e,[l,d]=(0,n.useState)(!0),[u,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=setTimeout(()=>{h()},o);return()=>clearTimeout(e)},[o]);let h=()=>{m(!0),setTimeout(()=>{d(!1),c(t)},300)};return l?(0,a.jsx)("div",{className:"\n        fixed top-4 right-4 z-50 max-w-sm w-full\n        border rounded-lg shadow-lg p-4\n        transform transition-all duration-300 ease-in-out\n        ".concat((()=>{switch(i){case"success":return"bg-green-50 border-green-200 text-green-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}})(),"\n        ").concat(u?"translate-x-full opacity-0":"translate-x-0 opacity-100","\n      "),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("span",{className:"text-lg",children:(()=>{switch(i){case"success":return"✓";case"warning":return"⚠";case"error":return"✕";default:return"ℹ"}})()})}),(0,a.jsxs)("div",{className:"ml-3 flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:s}),(0,a.jsx)("p",{className:"text-sm mt-1",children:r})]}),(0,a.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,a.jsxs)("button",{onClick:h,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:[(0,a.jsx)("span",{className:"sr-only",children:"Close"}),(0,a.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})}):null},l=e=>{let{children:t}=e,{notifications:s,markAsRead:r}=o(),[i,l]=(0,n.useState)([]);(0,n.useEffect)(()=>{l(s.filter(e=>"read"!==e.status).map(e=>({id:e.id,title:e.title,message:e.message,type:d(e.type)})))},[s]);let d=e=>{switch(e){case"event_starting":case"session_starting":return"warning";case"connection_accepted":case"registration_confirmation":return"success";default:return"info"}},u=e=>{l(t=>t.filter(t=>t.id!==e)),r(e)};return(0,a.jsxs)(a.Fragment,{children:[t,i.map(e=>(0,a.jsx)(c,{...e,onClose:u},e.id))]})},d=()=>{let[e,t]=(0,n.useState)(!1),[r,i]=(0,n.useState)("connecting"),[o,c]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=async()=>{try{i("connecting");let{supabase:e}=await Promise.resolve().then(s.bind(s,5526)),{data:a,error:n}=await e.from("events").select("id").limit(1);n?(i("error"),c(n.message),t(!1)):(i("connected"),c(null),t(!0))}catch(e){i("error"),c("Failed to connect to Supabase"),t(!1)}};e();let a=setInterval(e,3e4);return()=>clearInterval(a)},[]),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e?"bg-green-500":"error"===r?"bg-red-500":"bg-yellow-500")}),(0,a.jsx)("span",{children:e?"Connected":"error"===r?"Error":"disconnected"===r?"Disconnected":"Connecting..."}),o&&(0,a.jsxs)("span",{className:"text-red-500 text-xs",children:["(",o,")"]})]})}},949:function(e,t,s){"use strict";s.d(t,{Ho:function(){return d},aC:function(){return u}});var a=s(7437),n=s(2265),r=s(5526),i=s(3464);class o{setAuthToken(e){this.authToken=e}async getEvents(e){return(await this.client.get("/events",{params:e})).data}async getEvent(e){return(await this.client.get("/events/".concat(e))).data}async createEvent(e){return(await this.client.post("/events",e)).data}async updateEvent(e,t){return(await this.client.put("/events/".concat(e),t)).data}async deleteEvent(e){return(await this.client.delete("/events/".concat(e))).data}async registerForEvent(e){return(await this.client.post("/events/".concat(e,"/register"))).data}async getSessions(e,t){return(await this.client.get(e?"/events/".concat(e,"/sessions"):"/sessions",{params:t})).data}async getSession(e){return(await this.client.get("/sessions/".concat(e))).data}async createSession(e){return(await this.client.post("/sessions",e)).data}async updateSession(e,t){return(await this.client.put("/sessions/".concat(e),t)).data}async deleteSession(e){return(await this.client.delete("/sessions/".concat(e))).data}async getNotifications(e){return(await this.client.get("/notifications",{params:e})).data}async sendNotification(e){return(await this.client.post("/notifications",e)).data}async getConnections(e){return(await this.client.get("/networking/connections",{params:e})).data}async requestConnection(e){return(await this.client.post("/networking/connect",e)).data}async acceptConnection(e){return(await this.client.post("/networking/connections/".concat(e,"/accept"))).data}constructor(){this.authToken=null,this.client=i.Z.create({baseURL:"/api/v1",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>(this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),e)),this.client.interceptors.response.use(e=>e,e=>Promise.reject(e))}}let c=new o,l=(0,n.createContext)(void 0);function d(e){let{children:t}=e,[s,i]=(0,n.useState)(null),[o,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{r.supabase.auth.getSession().then(e=>{let{data:{session:t}}=e;d(t),i((null==t?void 0:t.user)?m(t.user):null),h(!1)});let{data:{subscription:e}}=r.supabase.auth.onAuthStateChange(async(e,t)=>{d(t),i((null==t?void 0:t.user)?m(t.user):null),h(!1),(null==t?void 0:t.access_token)?c.setAuthToken(t.access_token):c.setAuthToken(null)});return()=>e.unsubscribe()},[]);let g=async(e,t,s)=>{let{error:a}=await r.supabase.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback"),data:{full_name:s||e.split("@")[0]}}});return{error:a}},p=async(e,t)=>{let{error:s}=await r.supabase.auth.signInWithPassword({email:e,password:t});return{error:s}},v=async()=>{let{error:e}=await r.supabase.auth.signOut();return{error:e}},f=async e=>{let{error:t}=await r.supabase.auth.resetPasswordForEmail(e);return{error:t}};return(0,a.jsx)(l.Provider,{value:{user:s,session:o,loading:u,signUp:g,signIn:p,signOut:v,resetPassword:f},children:t})}function u(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function m(e){var t,s,a,n,r,i,o;return{id:e.id,email:e.email||"",role:"attendee",profile:{firstName:(null===(s=e.user_metadata)||void 0===s?void 0:null===(t=s.full_name)||void 0===t?void 0:t.split(" ")[0])||(null===(a=e.user_metadata)||void 0===a?void 0:a.first_name),lastName:(null===(r=e.user_metadata)||void 0===r?void 0:null===(n=r.full_name)||void 0===n?void 0:n.split(" ").slice(1).join(" "))||(null===(i=e.user_metadata)||void 0===i?void 0:i.last_name),avatar:null===(o=e.user_metadata)||void 0===o?void 0:o.avatar_url}}}},8285:function(e,t,s){"use strict";s.d(t,{H:function(){return n}});var a=s(5526);class n{async ensureUserExists(e){try{let{data:a,error:n}=await this.supabase.from("users").select("id").eq("id",e).single();if(a)return;if(n&&"PGRST116"===n.code){var t,s;let{data:a,error:n}=await this.supabase.auth.getUser();if(n||!(null==a?void 0:a.user))throw Error("User authentication failed");if(a.user.id!==e)throw Error("User ID mismatch");let r=(null===(t=a.user.user_metadata)||void 0===t?void 0:t.full_name)||(null===(s=a.user.email)||void 0===s?void 0:s.split("@")[0])||"User",i={id:e,email:a.user.email||"unknown@example.com",name:r},{data:o,error:c}=await this.supabase.from("users").insert(i).select().single();if(c)throw Error("Failed to create user: ".concat(c.message))}else if(n)throw Error("Failed to check user existence: ".concat(n.message))}catch(e){throw Error("Failed to ensure user exists: ".concat(e instanceof Error?e.message:"Unknown error"))}}async registerAttendee(e){try{var t;await this.ensureUserExists(e.userId);let{data:s,error:a}=await this.supabase.from("events").select("capacity").eq("id",e.eventId).single();if(a||!s)throw Error("Event not found");let{count:n}=await this.supabase.from("attendees").select("*",{count:"exact",head:!0}).eq("event_id",e.eventId).eq("status","registered");if((n||0)>=s.capacity)throw Error("Event is at full capacity. Registration is no longer available.");let{data:r,error:i}=await this.supabase.from("attendees").select("id, status").eq("event_id",e.eventId).eq("user_id",e.userId).single();if(r)throw Error("You are already registered for this event");if(i&&"PGRST116"!==i.code)throw Error("Failed to check existing registration: ".concat(i.message));let o={id:crypto.randomUUID(),eventId:e.eventId,userId:e.userId,type:e.type||"attendee",status:"registered",registrationDate:new Date().toISOString(),metadata:{...e.metadata,customFields:{...null===(t=e.metadata)||void 0===t?void 0:t.customFields}},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{error:c}=await this.supabase.from("attendees").insert({id:o.id,event_id:o.eventId,user_id:o.userId,status:o.status,registration_date:o.registrationDate,metadata:o.metadata});if(c)throw Error("Database error: ".concat(c.message));return o}catch(e){throw Error("Failed to register attendee: ".concat(e instanceof Error?e.message:"Unknown error"))}}async isUserRegistered(e,t){try{let{data:s,error:a}=await this.supabase.from("attendees").select("id").eq("event_id",e).eq("user_id",t).single();if(a&&"PGRST116"!==a.code)throw Error("Failed to check registration: ".concat(a.message));return!!s}catch(e){return!1}}async getAttendeesByUser(e){try{let{data:t,error:s}=await this.supabase.from("attendees").select("*").eq("user_id",e).order("registration_date",{ascending:!1});if(s||!t||!Array.isArray(t))return[];return t.map(e=>{try{return this.mapRowToAttendee(e)}catch(t){return{id:e.id||"unknown",eventId:e.event_id||"unknown",userId:e.user_id||"unknown",status:e.status||"registered",type:e.type||"attendee",registrationDate:e.registration_date||new Date().toISOString(),checkInDate:e.check_in_date,checkOutDate:e.check_out_date,metadata:{customFields:{},notes:e.notes||""},createdAt:e.created_at||new Date().toISOString(),updatedAt:e.updated_at||new Date().toISOString()}}})}catch(e){return[]}}async getAttendeeById(e){try{let{data:t,error:s}=await this.supabase.from("attendees").select("*").eq("id",e).single();if(s){if("PGRST116"===s.code)return null;throw Error("Database error: ".concat(s.message))}return this.mapRowToAttendee(t)}catch(e){throw Error("Failed to get attendee: ".concat(e instanceof Error?e.message:"Unknown error"))}}async updateAttendee(e,t){try{let s={};void 0!==t.status&&(s.status=t.status),void 0!==t.metadata&&(s.metadata=t.metadata),void 0!==t.checkInDate&&(s.check_in_date=t.checkInDate),void 0!==t.checkOutDate&&(s.check_out_date=t.checkOutDate),s.updated_at=new Date().toISOString();let{data:a,error:n}=await this.supabase.from("attendees").update(s).eq("id",e).select().single();if(n)throw Error("Database error: ".concat(n.message));return this.mapRowToAttendee(a)}catch(e){throw Error("Failed to update attendee: ".concat(e instanceof Error?e.message:"Unknown error"))}}async checkInAttendee(e){try{let{data:t,error:s}=await this.supabase.from("attendees").update({status:"checked_in",check_in_time:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw Error("Database error: ".concat(s.message));return this.mapRowToAttendee(t)}catch(e){throw Error("Failed to check in attendee: ".concat(e instanceof Error?e.message:"Unknown error"))}}async checkOutAttendee(e){try{let{data:t,error:s}=await this.supabase.from("attendees").update({status:"checked_out",check_out_time:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw Error("Database error: ".concat(s.message));return this.mapRowToAttendee(t)}catch(e){throw Error("Failed to check out attendee: ".concat(e instanceof Error?e.message:"Unknown error"))}}async listEventAttendees(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{status:s,page:a=1,limit:n=20}=t,r=this.supabase.from("attendees").select("*",{count:"exact"}).eq("event_id",e);s&&(r=r.eq("status",s));let i=(a-1)*n;r=(r=r.range(i,i+n-1)).order("registration_date",{ascending:!1});let{data:o,error:c,count:l}=await r;if(c)throw Error("Database error: ".concat(c.message));return{data:o.map(e=>this.mapRowToAttendee(e)),total:l||0,page:a,limit:n}}catch(e){throw Error("Failed to list event attendees: ".concat(e instanceof Error?e.message:"Unknown error"))}}async getEventAttendeeCount(e){try{let{count:t,error:s}=await this.supabase.from("attendees").select("*",{count:"exact",head:!0}).eq("event_id",e);if(s)throw Error("Database error: ".concat(s.message));return t||0}catch(e){throw Error("Failed to get attendee count: ".concat(e instanceof Error?e.message:"Unknown error"))}}async cancelAttendeeRegistration(e){try{let{error:t}=await this.supabase.from("attendees").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",e);if(t)throw Error("Database error: ".concat(t.message));return!0}catch(e){throw Error("Failed to cancel attendee registration: ".concat(e instanceof Error?e.message:"Unknown error"))}}mapRowToAttendee(e){var t;return{id:e.id,eventId:e.event_id,userId:e.user_id,status:e.status,type:e.type||"attendee",registrationDate:e.registration_date,checkInDate:e.check_in_date,checkOutDate:e.check_out_date,metadata:{...e.metadata,customFields:{...null===(t=e.metadata)||void 0===t?void 0:t.customFields,notes:e.notes||""}},createdAt:e.created_at,updatedAt:e.updated_at}}constructor(){this.supabase=a.supabase}}},3196:function(e,t,s){"use strict";s.d(t,{P:function(){return n}});var a=s(5526);class n{async createEvent(e){try{var t,s,a,n;let r=e.organizerId;if(!r)throw Error("Organizer ID is required");let{data:i,error:o}=await this.supabase.from("users").select("id").eq("id",r).single();if(o&&o.code,!i){let{data:e,error:a}=await this.supabase.auth.getUser();if(a||!(null==e?void 0:e.user))throw Error("User not authenticated");let n=(null===(t=e.user.user_metadata)||void 0===t?void 0:t.full_name)||(null===(s=e.user.email)||void 0===s?void 0:s.split("@")[0])||"Demo User",{data:i,error:o}=await this.supabase.from("users").insert({id:r,email:e.user.email||"demo@demo.com",name:n}).select().single();if(o||!i)throw Error("Failed to create user record: ".concat((null==o?void 0:o.message)||"Unknown error"))}let c={id:crypto.randomUUID(),title:e.title,description:e.description,startDate:e.startDate,endDate:e.endDate,metadata:{...e.metadata,timezone:"UTC",tags:[]},capacity:e.capacity,attendeeCount:0,type:e.type||"conference",status:"draft",organizerId:r,isPublic:null===(a=e.isPublic)||void 0===a||a,registrationOpen:null===(n=e.registrationOpen)||void 0===n||n,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{error:l}=await this.supabase.from("events").insert({id:c.id,title:c.title,description:c.description,start_date:c.startDate,end_date:c.endDate,capacity:c.capacity,status:c.status,organizer_id:c.organizerId,is_public:c.isPublic,metadata:c.metadata});if(l)throw Error("Database error: ".concat(l.message));return c}catch(e){throw Error("Failed to create event: ".concat(e instanceof Error?e.message:"Unknown error"))}}async getEventById(e){try{let{data:t,error:s}=await this.supabase.from("events").select("*").eq("id",e).single();if(s){if("PGRST116"===s.code)return null;throw Error("Database error: ".concat(s.message))}return await this.mapRowToEvent(t)}catch(e){throw Error("Failed to get event: ".concat(e instanceof Error?e.message:"Unknown error"))}}async updateEvent(e,t,s){try{if(s){let t=await this.getEventById(e);if(!t)throw Error("Event not found");if(t.organizerId!==s)throw Error("You do not have permission to update this event")}let a={};void 0!==t.title&&(a.title=t.title),void 0!==t.description&&(a.description=t.description),void 0!==t.startDate&&(a.start_date=t.startDate),void 0!==t.endDate&&(a.end_date=t.endDate),void 0!==t.capacity&&(a.capacity=t.capacity),void 0!==t.status&&(a.status=t.status),void 0!==t.isPublic&&(a.is_public=t.isPublic),void 0!==t.metadata&&(a.metadata=t.metadata),a.updated_at=new Date().toISOString();let{data:n,error:r}=await this.supabase.from("events").update(a).eq("id",e).select().single();if(r)throw Error("Database error: ".concat(r.message));return await this.mapRowToEvent(n)}catch(e){throw Error("Failed to update event: ".concat(e instanceof Error?e.message:"Unknown error"))}}async deleteEvent(e,t){try{let{error:s}=await this.supabase.from("events").delete().eq("id",e).eq("organizer_id",t);if(s)throw Error("Database error: ".concat(s.message));return!0}catch(e){throw Error("Failed to delete event: ".concat(e instanceof Error?e.message:"Unknown error"))}}async listEvents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{organizerId:t,status:s,isPublic:a,search:n,page:r=1,limit:i=20,userId:o}=e,c=this.supabase.from("events").select("*",{count:"exact"});t&&(c=c.eq("organizer_id",t)),s&&(c=c.eq("status",s)),void 0!==a&&(c=c.eq("is_public",a)),n&&(c=c.or("title.ilike.%".concat(n,"%,description.ilike.%").concat(n,"%")));let l=(r-1)*i;c=(c=c.range(l,l+i-1)).order("created_at",{ascending:!1});let{data:d,error:u,count:m}=await c;if(u)throw Error("Database error: ".concat(u.message));return{data:await Promise.all(d.map(e=>this.mapRowToEvent(e))),total:m||0,page:r,limit:i}}catch(e){throw Error("Failed to list events: ".concat(e instanceof Error?e.message:"Unknown error"))}}async updateEventStatus(e,t,s){try{let{data:a,error:n}=await this.supabase.from("events").update({status:t,updated_at:new Date().toISOString()}).eq("id",e).eq("organizer_id",s).select().single();if(n)throw Error("Database error: ".concat(n.message));return await this.mapRowToEvent(a)}catch(e){throw Error("Failed to update event status: ".concat(e instanceof Error?e.message:"Unknown error"))}}async getEventAnalytics(e){try{let{count:t}=await this.supabase.from("attendees").select("*",{count:"exact",head:!0}).eq("event_id",e),{count:s}=await this.supabase.from("attendees").select("*",{count:"exact",head:!0}).eq("event_id",e).eq("status","checked_in"),{data:a}=await this.supabase.from("attendees").select("created_at").eq("event_id",e).gte("created_at",new Date(Date.now()-2592e6).toISOString()),n=new Map;null==a||a.forEach(e=>{let t=e.created_at.split("T")[0];n.set(t,(n.get(t)||0)+1)});let r=Array.from(n.entries()).map(e=>{let[t,s]=e;return{date:t,count:s}}),{data:i}=await this.supabase.from("attendees").select("\n          user_id,\n          users!inner(timezone)\n        ").eq("event_id",e),o=new Map;null==i||i.forEach(e=>{var t;let s=(null===(t=e.users)||void 0===t?void 0:t.timezone)||"UTC";o.set(s,(o.get(s)||0)+1)});let c=Array.from(o.entries()).map(e=>{let[t,s]=e;return{timezone:t,count:s}}),{count:l}=await this.supabase.from("connections").select("*",{count:"exact",head:!0}).eq("event_id",e).eq("status","accepted");return{totalRegistrations:t||0,totalAttendees:s||0,attendanceRate:(t||0)>0?(s||0)/(t||1)*100:0,registrationTrend:r,attendeeDemographics:{byLocation:[],byTimezone:c},engagementMetrics:{averageSessionAttendance:0,networkingConnections:l||0,messageCount:0}}}catch(e){throw Error("Failed to get event analytics: ".concat(e instanceof Error?e.message:"Unknown error"))}}async isEventAtCapacity(e){try{let t=await this.getEventById(e);if(!t)throw Error("Event not found");let{count:s}=await this.supabase.from("attendees").select("*",{count:"exact",head:!0}).eq("event_id",e).eq("status","registered");return(s||0)>=t.capacity}catch(e){throw Error("Failed to check event capacity: ".concat(e instanceof Error?e.message:"Unknown error"))}}async getEventWaitlist(e){try{let{data:t,error:s}=await this.supabase.from("event_waitlist").select("user_id, created_at").eq("event_id",e).order("created_at",{ascending:!0});if(s)throw Error("Database error: ".concat(s.message));return t.map((e,t)=>({userId:e.user_id,position:t+1,requestedAt:e.created_at}))}catch(e){throw Error("Failed to get event waitlist: ".concat(e instanceof Error?e.message:"Unknown error"))}}async mapRowToEvent(e){var t;let s=0;try{let{count:t}=await this.supabase.from("attendees").select("id",{count:"exact"}).eq("event_id",e.id);s=t||0}catch(t){try{let{count:t}=await this.supabase.from("event_attendees").select("id",{count:"exact"}).eq("event_id",e.id);s=t||0}catch(e){s=0}}return{id:e.id,title:e.title,description:e.description,startDate:e.start_date,endDate:e.end_date,capacity:e.capacity,attendeeCount:s,type:e.type||"conference",status:e.status,organizerId:e.organizer_id,isPublic:e.is_public,registrationOpen:null===(t=e.registration_open)||void 0===t||t,metadata:e.metadata||{},createdAt:e.created_at,updatedAt:e.updated_at}}constructor(){this.supabase=a.supabase}}},7181:function(e,t,s){"use strict";s.d(t,{c:function(){return r}});var a=s(5526);class n{async trackConnection(e,t){let s="".concat(e,"-").concat(t),n=new Date;this.connections.set(s,{userId:e,eventId:t,connectedAt:n,lastSeen:n});try{let s=a.supabase.channel("event-connections-".concat(t));await s.send({type:"broadcast",event:"user-connected",payload:{userId:e,eventId:t,connectedAt:n.toISOString(),activeConnections:this.getActiveConnectionsForEvent(t)}})}catch(e){}}updateLastSeen(e,t){let s="".concat(e,"-").concat(t),a=this.connections.get(s);a&&(a.lastSeen=new Date,this.connections.set(s,a))}async removeConnection(e,t){let s="".concat(e,"-").concat(t);this.connections.delete(s);try{let s=a.supabase.channel("event-connections-".concat(t));await s.send({type:"broadcast",event:"user-disconnected",payload:{userId:e,eventId:t,activeConnections:this.getActiveConnectionsForEvent(t)}})}catch(e){}}getActiveConnectionsForEvent(e){let t=new Date(Date.now()-3e5);return Array.from(this.connections.values()).filter(s=>s.eventId===e&&s.lastSeen>=t).length}getActiveConnections(){let e=new Date(Date.now()-3e5);return Array.from(this.connections.values()).filter(t=>t.lastSeen>=e).length}getConnectionInfo(e,t){let s="".concat(e,"-").concat(t);return this.connections.get(s)||null}startCleanup(){this.cleanupInterval=setInterval(()=>{let e=new Date(Date.now()-3e5);for(let[t,s]of this.connections.entries())s.lastSeen<e&&this.connections.delete(t)},6e4)}destroy(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}constructor(){this.connections=new Map,this.cleanupInterval=null,this.startCleanup()}}let r=new n},5526:function(e,t,s){"use strict";s.r(t),s.d(t,{supabase:function(){return r}});var a=s(3887);let n=null,r=new Proxy({},{get:(e,t)=>(function(){if(!n){let e="https://inmxxawvfymvftcqqemg.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlubXh4YXd2ZnltdmZ0Y3FxZW1nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0MDQ1NzcsImV4cCI6MjA3NDk4MDU3N30.QMwgAFn2AOZH7AH-weRw9kXlwxMi3R51X6pwsxlNiig";if(!e||!t)throw Error("Missing required Supabase environment variables");n=(0,a.eI)(e,t)}return n})()[t]});t.default=r},3254:function(e,t,s){"use strict";s.d(t,{V:function(){return m},p:function(){return u}});var a=s(7437),n=s(2265),r=s(1671),i=s(9322),o=s(6865),c=s(3245),l=s(2489);let d=(0,n.createContext)(void 0);function u(){let e=(0,n.useContext)(d);if(!e)throw Error("useToast must be used within a ToastProvider");return e}function m(e){let{children:t}=e,[s,r]=(0,n.useState)([]),i=(0,n.useCallback)(e=>{let t=Math.random().toString(36).substr(2,9),s={...e,id:t};r(e=>[...e,s]),setTimeout(()=>{o(t)},e.duration||5e3)},[]),o=(0,n.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),c=(0,n.useCallback)((e,t,s)=>{i({type:"success",title:e,message:t,duration:s})},[i]),l=(0,n.useCallback)((e,t,s)=>{i({type:"error",title:e,message:t,duration:s})},[i]),u=(0,n.useCallback)((e,t,s)=>{i({type:"warning",title:e,message:t,duration:s})},[i]),m=(0,n.useCallback)((e,t,s)=>{i({type:"info",title:e,message:t,duration:s})},[i]);return(0,a.jsxs)(d.Provider,{value:{toasts:s,addToast:i,removeToast:o,success:c,error:l,warning:u,info:m},children:[t,(0,a.jsx)(h,{toasts:s,onRemove:o})]})}function h(e){let{toasts:t,onRemove:s}=e;return(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full",children:t.map(e=>(0,a.jsx)(g,{toast:e,onRemove:s},e.id))})}function g(e){let{toast:t,onRemove:s}=e,n=(()=>{switch(t.type){case"success":return{container:"bg-green-50 border-green-200 text-green-800",icon:"text-green-500",iconBg:"bg-green-100",Icon:r.Z};case"error":return{container:"bg-red-50 border-red-200 text-red-800",icon:"text-red-500",iconBg:"bg-red-100",Icon:i.Z};case"warning":return{container:"bg-yellow-50 border-yellow-200 text-yellow-800",icon:"text-yellow-500",iconBg:"bg-yellow-100",Icon:o.Z};case"info":return{container:"bg-blue-50 border-blue-200 text-blue-800",icon:"text-blue-500",iconBg:"bg-blue-100",Icon:c.Z};default:return{container:"bg-gray-50 border-gray-200 text-gray-800",icon:"text-gray-500",iconBg:"bg-gray-100",Icon:c.Z}}})(),{Icon:d}=n;return(0,a.jsxs)("div",{className:"\n        relative flex items-start p-4 rounded-lg border shadow-lg\n        transform transition-all duration-300 ease-in-out\n        hover:shadow-xl hover:scale-[1.02]\n        animate-in slide-in-from-right-full\n        ".concat(n.container,"\n      "),children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full ".concat(n.iconBg," flex items-center justify-center mr-3"),children:(0,a.jsx)(d,{className:"w-5 h-5 ".concat(n.icon)})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold leading-5",children:t.title}),t.message&&(0,a.jsx)("p",{className:"mt-1 text-sm opacity-90 leading-5",children:t.message})]}),(0,a.jsx)("button",{onClick:()=>s(t.id),className:"\n          flex-shrink-0 ml-3 p-1 rounded-full\n          hover:bg-black hover:bg-opacity-10\n          transition-colors duration-200\n          ".concat(n.icon,"\n        "),"aria-label":"Close notification",children:(0,a.jsx)(l.Z,{className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black bg-opacity-10 rounded-b-lg overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-current opacity-30 animate-progress",style:{animation:"progress ".concat(t.duration||5e3,"ms linear forwards")}})})]})}if("undefined"!=typeof document){let e=document.createElement("style");e.textContent="\n    @keyframes progress {\n      from { width: 100%; }\n      to { width: 0%; }\n    }\n    \n    .animate-progress {\n      animation-fill-mode: forwards;\n    }\n  ",document.head.appendChild(e)}},5725:function(e,t,s){"use strict";s.d(t,{zx:function(){return m},Zb:function(){return h},Uo:function(){return d},TK:function(){return l},oX:function(){return u}});var a=s(7437),n=s(2265);let r={xs:"0px",sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"};class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}updateBreakpoint(){let e=window.innerWidth,t="xs",s="mobile";e>=parseInt(r["2xl"])?(t="2xl",s="desktop"):e>=parseInt(r.xl)?(t="xl",s="desktop"):e>=parseInt(r.lg)?(t="lg",s="desktop"):e>=parseInt(r.md)?(t="md",s="tablet"):(t=e>=parseInt(r.sm)?"sm":"xs",s="mobile"),(t!==this.currentBreakpoint||s!==this.currentDeviceType)&&(this.currentBreakpoint=t,this.currentDeviceType=s,this.notifyListeners())}notifyListeners(){this.listeners.forEach(e=>{e(this.currentBreakpoint,this.currentDeviceType)})}getCurrentBreakpoint(){return this.currentBreakpoint}getCurrentDeviceType(){return this.currentDeviceType}isMobile(){return"mobile"===this.currentDeviceType}isTablet(){return"tablet"===this.currentDeviceType}isDesktop(){return"desktop"===this.currentDeviceType}isBreakpoint(e){return this.currentBreakpoint===e}isBreakpointOrAbove(e){let t=["xs","sm","md","lg","xl","2xl"];return t.indexOf(this.currentBreakpoint)>=t.indexOf(e)}isBreakpointOrBelow(e){let t=["xs","sm","md","lg","xl","2xl"];return t.indexOf(this.currentBreakpoint)<=t.indexOf(e)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}getResponsiveClasses(e,t){let s=e;return Object.entries(t).forEach(e=>{let[t,a]=e;a&&this.isBreakpointOrAbove(t)&&(s+=" ".concat(a))}),s}getMediaQuery(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up",s=r[e];return"up"===t?"(min-width: ".concat(s,")"):"(max-width: ".concat(parseInt(s)-1,"px)")}getResponsiveValue(e,t){let s=["xs","sm","md","lg","xl","2xl"];for(let t=s.indexOf(this.currentBreakpoint);t>=0;t--){let a=s[t];if(void 0!==e[a])return e[a]}return t}constructor(){this.currentBreakpoint="md",this.currentDeviceType="desktop",this.listeners=new Set,this.handleResize=()=>{this.updateBreakpoint()},this.updateBreakpoint(),window.addEventListener("resize",this.handleResize.bind(this))}}let o=i.getInstance();var c=s(3481);let l=e=>{let{size:t="md",color:s="primary",className:n=""}=e,{getColor:r}=(0,c.Fg)();return(0,a.jsx)("div",{className:"animate-spin ".concat((()=>{switch(t){case"sm":return"w-4 h-4";case"lg":return"w-8 h-8";case"xl":return"w-12 h-12";default:return"w-6 h-6"}})()," ").concat((()=>{switch(s){case"secondary":return"text-gray-500";case"white":return"text-white";default:return"text-blue-500"}})()," ").concat(n),children:(0,a.jsxs)("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},d=e=>{let{children:t,delay:s=0,duration:r=300,className:i=""}=e,[o,c]=n.useState(!1);return n.useEffect(()=>{let e=setTimeout(()=>{c(!0)},s);return()=>clearTimeout(e)},[s]),(0,a.jsx)("div",{className:"transition-opacity duration-".concat(r," ").concat(o?"opacity-100":"opacity-0"," ").concat(i),children:t})},u=e=>{let{children:t,direction:s="up",delay:r=0,duration:i=300,className:o=""}=e,[c,l]=n.useState(!1);return n.useEffect(()=>{let e=setTimeout(()=>{l(!0)},r);return()=>clearTimeout(e)},[r]),(0,a.jsx)("div",{className:"transition-transform duration-".concat(i," ").concat((()=>{switch(s){case"up":default:return c?"translate-y-0":"translate-y-4";case"down":return c?"translate-y-0":"-translate-y-4";case"left":return c?"translate-x-0":"translate-x-4";case"right":return c?"translate-x-0":"-translate-x-4"}})()," ").concat(o),children:t})},m=e=>{let{children:t,variant:s="primary",size:r="md",loading:i=!1,leftIcon:c,rightIcon:d,fullWidth:u=!1,className:m="",disabled:h,...g}=e,{isMobile:p}=function(){let[e,t]=n.useState(o.getCurrentBreakpoint()),[s,a]=n.useState(o.getCurrentDeviceType());return n.useEffect(()=>o.subscribe((e,s)=>{t(e),a(s)}),[]),{breakpoint:e,deviceType:s,isMobile:o.isMobile(),isTablet:o.isTablet(),isDesktop:o.isDesktop(),isBreakpoint:o.isBreakpoint.bind(o),isBreakpointOrAbove:o.isBreakpointOrAbove.bind(o),isBreakpointOrBelow:o.isBreakpointOrBelow.bind(o),getResponsiveValue:o.getResponsiveValue.bind(o)}}(),v=h||i;return(0,a.jsxs)("button",{className:"\n        inline-flex items-center justify-center\n        font-medium rounded-lg\n        transition-colors duration-200\n        focus:outline-none focus:ring-2 focus:ring-offset-2\n        disabled:opacity-50 disabled:cursor-not-allowed\n        ".concat((()=>{switch(s){case"primary":default:return"bg-blue-500 text-white hover:bg-blue-600 focus:ring-blue-500";case"secondary":return"bg-gray-500 text-white hover:bg-gray-600 focus:ring-gray-500";case"outline":return"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-blue-500 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700";case"ghost":return"text-gray-700 hover:bg-gray-100 focus:ring-blue-500 dark:text-gray-300 dark:hover:bg-gray-700";case"danger":return"bg-red-500 text-white hover:bg-red-600 focus:ring-red-500"}})(),"\n        ").concat((()=>{switch(r){case"sm":return"px-3 py-1.5 text-sm";case"lg":return"px-6 py-3 text-lg";default:return"px-4 py-2 text-base"}})(),"\n        ").concat(u?"w-full":"","\n        ").concat(m,"\n      "),disabled:v,...g,children:[i&&(0,a.jsx)(l,{size:"sm",color:"white",className:"mr-2"}),!i&&c&&(0,a.jsx)("span",{className:"mr-2",children:c}),t,!i&&d&&(0,a.jsx)("span",{className:"ml-2",children:d})]})},h=e=>{let{children:t,className:s="",hover:n=!1,padding:r="md",shadow:i="md"}=e,{getShadow:o}=(0,c.Fg)();return(0,a.jsx)("div",{className:"\n        bg-white dark:bg-gray-800\n        border border-gray-200 dark:border-gray-700\n        rounded-lg\n        ".concat((()=>{switch(r){case"sm":return"p-4";case"lg":return"p-8";default:return"p-6"}})(),"\n        ").concat((()=>{switch(i){case"sm":return"shadow-sm";case"lg":return"shadow-lg";case"xl":return"shadow-xl";default:return"shadow-md"}})(),"\n        ").concat(n?"hover:shadow-lg transition-shadow duration-200":"","\n        ").concat(s,"\n      "),children:t})}},3481:function(e,t,s){"use strict";s.d(t,{Fg:function(){return l},Tl:function(){return u},f6:function(){return d}});var a=s(7437),n=s(2265);let r={name:"light",colors:{background:"#ffffff",backgroundSecondary:"#f8fafc",backgroundTertiary:"#f1f5f9",text:"#1e293b",textSecondary:"#64748b",textTertiary:"#94a3b8",border:"#e2e8f0",borderSecondary:"#cbd5e1",primary:"#3b82f6",primaryHover:"#2563eb",primaryActive:"#1d4ed8",secondary:"#64748b",secondaryHover:"#475569",secondaryActive:"#334155",success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#06b6d4",hover:"#f1f5f9",active:"#e2e8f0",focus:"#3b82f6",shadow:"rgba(0, 0, 0, 0.1)",shadowHover:"rgba(0, 0, 0, 0.15)"},fonts:{primary:"Inter, system-ui, sans-serif",secondary:"Inter, system-ui, sans-serif",mono:"JetBrains Mono, Consolas, monospace"},spacing:{xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem","2xl":"3rem"},borderRadius:{sm:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem"},shadows:{sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}},i={name:"dark",colors:{background:"#0f172a",backgroundSecondary:"#1e293b",backgroundTertiary:"#334155",text:"#f8fafc",textSecondary:"#cbd5e1",textTertiary:"#94a3b8",border:"#475569",borderSecondary:"#64748b",primary:"#3b82f6",primaryHover:"#2563eb",primaryActive:"#1d4ed8",secondary:"#64748b",secondaryHover:"#475569",secondaryActive:"#334155",success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#06b6d4",hover:"#1e293b",active:"#334155",focus:"#3b82f6",shadow:"rgba(0, 0, 0, 0.3)",shadowHover:"rgba(0, 0, 0, 0.4)"},fonts:{primary:"Inter, system-ui, sans-serif",secondary:"Inter, system-ui, sans-serif",mono:"JetBrains Mono, Consolas, monospace"},spacing:{xs:"0.25rem",sm:"0.5rem",md:"1rem",lg:"1.5rem",xl:"2rem","2xl":"3rem"},borderRadius:{sm:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem"},shadows:{sm:"0 1px 2px 0 rgba(0, 0, 0, 0.3)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.3)"}};class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}loadThemeFromStorage(){try{let e=localStorage.getItem("theme-mode");e&&["light","dark","system"].includes(e)&&(this.currentMode=e)}catch(e){}}saveThemeToStorage(){try{localStorage.setItem("theme-mode",this.currentMode)}catch(e){}}setupSystemThemeListener(){this.mediaQuery=window.matchMedia("(prefers-color-scheme: dark)"),this.mediaQuery.addEventListener("change",this.handleSystemThemeChange.bind(this))}updateCurrentTheme(){if("dark"===this.currentMode)this.currentTheme=i;else if("light"===this.currentMode)this.currentTheme=r;else{var e,t;let s=null!==(t=null===(e=this.mediaQuery)||void 0===e?void 0:e.matches)&&void 0!==t&&t;this.currentTheme=s?i:r}}applyTheme(){if("undefined"==typeof document)return;this.updateCurrentTheme();let e=document.documentElement,t=this.currentTheme;if(Object.entries(t.colors).forEach(t=>{let[s,a]=t;e.style.setProperty("--color-".concat(s),a)}),Object.entries(t.fonts).forEach(t=>{let[s,a]=t;e.style.setProperty("--font-".concat(s),a)}),Object.entries(t.spacing).forEach(t=>{let[s,a]=t;e.style.setProperty("--spacing-".concat(s),a)}),Object.entries(t.borderRadius).forEach(t=>{let[s,a]=t;e.style.setProperty("--radius-".concat(s),a)}),Object.entries(t.shadows).forEach(t=>{let[s,a]=t;e.style.setProperty("--shadow-".concat(s),a)}),document.body.className=document.body.className.replace(/theme-\w+/g,""),document.body.classList.add("theme-".concat(t.name)),"dark"===this.currentMode)e.classList.add("dark");else if("light"===this.currentMode)e.classList.remove("dark");else{var s,a;null!==(a=null===(s=this.mediaQuery)||void 0===s?void 0:s.matches)&&void 0!==a&&a?e.classList.add("dark"):e.classList.remove("dark")}}notifyListeners(){this.listeners.forEach(e=>{e(this.currentTheme,this.currentMode)})}getCurrentTheme(){return this.currentTheme}getCurrentMode(){return this.currentMode}setThemeMode(e){this.currentMode=e,this.saveThemeToStorage(),this.applyTheme(),this.notifyListeners()}toggleTheme(){"light"===this.currentMode?this.setThemeMode("dark"):"dark"===this.currentMode?this.setThemeMode("system"):this.setThemeMode("light")}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}getColor(e){return this.currentTheme.colors[e]}getSpacing(e){return this.currentTheme.spacing[e]}getBorderRadius(e){return this.currentTheme.borderRadius[e]}getShadow(e){return this.currentTheme.shadows[e]}constructor(){this.currentTheme=r,this.currentMode="system",this.listeners=new Set,this.mediaQuery=null,this.handleSystemThemeChange=e=>{"system"===this.currentMode&&(this.updateCurrentTheme(),this.applyTheme(),this.notifyListeners())},this.loadThemeFromStorage(),this.setupSystemThemeListener(),this.applyTheme()}}let c=o.getInstance();function l(){let[e,t]=n.useState(c.getCurrentTheme()),[s,a]=n.useState(c.getCurrentMode());return n.useEffect(()=>c.subscribe((e,s)=>{t(e),a(s)}),[]),{theme:e,mode:s,setThemeMode:c.setThemeMode.bind(c),toggleTheme:c.toggleTheme.bind(c),getColor:c.getColor.bind(c),getSpacing:c.getSpacing.bind(c),getBorderRadius:c.getBorderRadius.bind(c),getShadow:c.getShadow.bind(c)}}let d=e=>{let{children:t}=e,{theme:s,mode:r}=l(),[i,o]=n.useState(!1);return n.useEffect(()=>{o(!0),c.applyTheme()},[s,r]),(0,a.jsx)(a.Fragment,{children:t})},u=e=>{let{className:t="",showLabel:s=!0}=e,{mode:n,toggleTheme:r}=l();return(0,a.jsxs)("button",{onClick:r,className:"flex items-center space-x-2 px-3 py-2 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ".concat(t),"aria-label":"Switch to ".concat("light"===n?"dark":"dark"===n?"system":"light"," theme"),children:[(()=>{switch(n){case"light":return(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})});case"dark":return(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})});case"system":return(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}})(),s&&(0,a.jsx)("span",{className:"text-sm font-medium",children:(()=>{switch(n){case"light":return"Light";case"dark":return"Dark";case"system":return"System"}})()})]})}}}]);